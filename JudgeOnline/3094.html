<html><head><meta charset="utf-8"/><link rel="icon" href="../image/logo32x32.png" sizes="32x32" /><link rel="icon" href="../image/logo192x192.png" sizes="192x192" /><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>[Acm BeiJing2012]Peach Blossom Spring</title></head><body><div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/logo.png"><span style="font-family: Lato,'Helvetica Neue',Arial,Helvetica,sans-serif; font-size: 1.3em; font-weight: 300; ">BZPRO</span></a></div><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">#3094. [Acm BeiJing2012]Peach Blossom Spring</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：128 MiB</span> <span class="ui label">时间限制：10 Sec</span></div></div><div class="ui grid"><div class="row"><div class="column"><div class="ui buttons"><a class="small ui primary button" href="https://www.lydsy.com/JudgeOnline/submitpage.php?id=3094">提交</a> <a class="small ui positive button" href="https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3094">提交记录</a> <a class="small ui yellow button" href="https://www.lydsy.com/JudgeOnline/wttl/wttl.php?pid=3094">讨论</a></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><p><span style="font-size: medium">Tao Yuanming(365-427) was a Chinese poet of Eastern Jin dynasty. One of his most famous works is &quot;Peach Blossom Spring&quot;, which is a fable about a chance<br />
discovery of an ethereal village where the people lead an ideal existence in harmony with nature, unaware of the outside world for centuries. So in Chinese, &quot;Peach Blossom Spring&quot; means &quot;utopia&quot;.<br />
In the story of &quot;Peach Blossom Spring&quot;, there was a mysterious place. In Qin dynasty, some people escaped to that place during the civil unrest and built a village. They and their descendants never left and never had any contact with the outside world since then, until centuries latter a fisherman of Jin dynasty found them.<br />
Recently, some Chinese ACMers happened to find the relics of the village mentioned in&quot;Peach Blossom Spring&quot;.<br />
They also found a document about building hiding places to escape from Qin army. The document said:<br />
There were n houses and m roads in the village. Each road connected two houses. These houses were numbered from 1 to n. There were k families, each living in a different house. <br />
The houses they lived were house 1, house 2, &hellip; , house k. There were also k broken houses: house n-k+1, house n-k+2, ... , house n, with secret basements so that those houses could be used as hiding places.<br />
The problem was that all roads were broken. People wanted to repair some roads so that every family could reach a hiding place through the repaired roads. Every hiding place could only hold one family. Each road cost some labor to be repaired. The head of the village wanted to find out the minimum cost way of repairing the roads, but he didn't know how to do.<br />
Would you solve the problem which the ancient village head never solved?</span></p></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><div class=content><div class="panel_content"><span style="font-size: medium">the first line begins with three integers ---- the above mentioned <span style="color: #ff0000">n (n&lt;=7000), m (0&lt;=m&lt;=10000) </span>and k (1&lt;=k&lt;=5, 2k&lt;=n). Then m lines follow, each containing three integers u,v and w, indicating that there is a broken road connecting house u an d v, and the cost to repair that road is w(1&lt;=w&lt;=1000).</span></div></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><div class=content><div class="panel_content"><span style="font-size: medium">&nbsp;if you cannot find a proper way to repair the roads, output&nbsp; <span style="color: #ff0000">-1</span>&nbsp;&nbsp;in a line. Otherwise, output the minimum cost to repair the roads in a line.</span></div>
<div class="panel_bottom"></div>
<div class="panel_content">
<pre>
	</pre>
</div></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">
			<div class=content><span class=sampledata>input 1<br />
4 3 1<br />
4 2 10<br />
3 1 9<br />
2 3 10<br />
<br />
input 2<br />
6 7 2<br />
1 5 1000<br />
2 6 1000<br />
1 3 1<br />
2 3 1<br />
3 4 1<br />
4 5 1<br />
4 6 1<br />
 <br />
<br />
 <br />
<br />
<br />
</span></div></code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">
			<div class=content><span class=sampledata>output 1<br />
29<br />
<br />
<br />
output 2<br />
5</span></div></code></pre></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">
			<div class=content><p></p></div></div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">BZPRO Powered by Remmina.</span><br/><a href="https://github.com/remmina/BZPRO">Github Repository</a></div></div></body></html>