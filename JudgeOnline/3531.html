<html><head><meta charset="utf-8"/><link rel="icon" href="../image/logo32x32.png" sizes="32x32" /><link rel="icon" href="../image/logo192x192.png" sizes="192x192" /><link rel="stylesheet" type="text/css" href="../Semantic/semantic.min.css"><script src="../Semantic/jquery.min.js" type="text/javascript"></script><script src="../Semantic/semantic.min.js" type="text/javascript"></script><title>[Sdoi2014]旅行</title></head><body><div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/logo.png"><span style="font-family: Lato,'Helvetica Neue',Arial,Helvetica,sans-serif; font-size: 1.3em; font-weight: 300; ">BZPRO</span></a></div><div class="ui main container"><div class="ui center aligned grid"><div class="row"><h1 class="ui header">#3531. [Sdoi2014]旅行</h1></div><div class="row" style="margin-top: -15px"><span class="ui label">内存限制：512 MiB</span> <span class="ui label">时间限制：40 Sec</span></div></div><div class="ui grid"><div class="row"><div class="column"><div class="ui buttons"><a class="small ui primary button" href="https://www.lydsy.com/JudgeOnline/submitpage.php?id=3531">提交</a> <a class="small ui positive button" href="https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3531">提交记录</a> <a class="small ui yellow button" href="https://www.lydsy.com/JudgeOnline/wttl/wttl.php?pid=3531">讨论</a></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">题目描述</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><p><span style="font-size: medium">&nbsp;S国有N个城市，编号从1到N。城市间用N-1条双向道路连接，满足<br />
从一个城市出发可以到达其它所有城市。每个城市信仰不同的宗教，如飞天面条神教、隐形独角兽教、绝地教都是常见的信仰。为了方便，我们用不同的正整数代表各种宗教，&nbsp; S国的居民常常旅行。旅行时他们总会走最短路，并且为了避免麻烦，只在信仰和他们相同的城市留宿。当然旅程的终点也是信仰与他相同的城市。S国政府为每个城市标定了不同的旅行评级，旅行者们常会记下途中（包括起点和终点）留宿过的城市的评级总和或最大值。<br />
&nbsp;&nbsp;&nbsp; 在S国的历史上常会发生以下几种事件：<br />
&rdquo;CC x c&rdquo;：城市x的居民全体改信了c教；<br />
&rdquo;CW x w&rdquo;：城市x的评级调整为w;<br />
&rdquo;QS x y&rdquo;：一位旅行者从城市x出发，到城市y，并记下了途中留宿过的城市的评级总和；<br />
&rdquo;QM x y&rdquo;：一位旅行者从城市x出发，到城市y，并记下了途中留宿过<br />
的城市的评级最大值。<br />
&nbsp;&nbsp;&nbsp; 由于年代久远，旅行者记下的数字已经遗失了，但记录开始之前每座城市的信仰与评级，还有事件记录本身是完好的。请根据这些信息，还原旅行者记下的数字。&nbsp;&nbsp;&nbsp; 为了方便，我们认为事件之间的间隔足够长，以致在任意一次旅行中，所有城市的评级和信仰保持不变。<br />
</span></p></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输入格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><div class=content><p><font size="4">&nbsp;&nbsp;&nbsp; 输入的第一行包含整数N，Q依次表示城市数和事件数。<br />
&nbsp;&nbsp;&nbsp; 接下来N行，第i+l行两个整数Wi，Ci依次表示记录开始之前，城市i的<br />
评级和信仰。<br />
&nbsp;&nbsp;&nbsp; 接下来N-1行每行两个整数x，y表示一条双向道路。<br />
&nbsp;&nbsp;&nbsp; 接下来Q行，每行一个操作，格式如上所述。<br />
</font></p></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">输出格式</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><div class=content><p><font size="4">&nbsp;&nbsp;&nbsp; 对每个QS和QM事件，输出一行，表示旅行者记下的数字。<br />
</font></p></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">样例</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;"><h4>样例输入</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">
			<div class=content><span class=sampledata>    5 6<br />
    3 1<br />
    2 3<br />
    1 2<br />
    3 3<br />
    5 1<br />
    1 2<br />
    1 3<br />
    3 4<br />
    3 5<br />
    QS 1 5<br />
    CC 3 1<br />
    QS 1 5<br />
    CW 3 3<br />
    QS 1 5<br />
    QM 2 4<br />
</span></div></code></pre></div><h4>样例输出</h4><div class="ui existing segment"><pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain">
			<div class=content><span class=sampledata>    8<br />
    9<br />
    11<br />
    3</span></div></code></pre></div></div></div></div></div><div class="row"><div class="column"><h4 class="ui top attached block header">数据范围与提示</h4><div class="ui bottom attached segment font-content"><div style="position: relative; overflow: hidden;">
			<div class=content><p><p><span style="font-size: medium">N，Q &lt; =10^5&nbsp;&nbsp;&nbsp;&nbsp;， C &lt; =10^5 </span></p><br />
<p><span style="font-size: medium">&nbsp;数据保证对所有QS和QM事件，起点和终点城市的信仰相同；在任意时<br /><br />
刻，城市的评级总是不大于10^4的正整数，且宗教值不大于C。</span></p></p></div></div></div></div></div></div></div><div class="ui vertical footer segment"><div class="ui center aligned container"><span style="color: #999;">BZPRO Powered by Remmina.</span><br/><a href="https://github.com/remmina/BZPRO">Github Repository</a></div></div></body></html>